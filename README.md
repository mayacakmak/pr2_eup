# robot_eup
High-level APIs for end-user programming of the PR2 and the Turtlebot. 
Based on Justin Huang's [rapid_robot](https://github.com/jstnhuang/rapid_robot).

## Package overview
- `pr2_eup` contains the library itself.
- `pr2_eup_samples` contains examples of how the interface can be used.

## Installation
 - Install [meteor](https://www.meteor.com/).
 - Install [pocketsphinx](http://wiki.ros.org/pocketsphinx)
 ```
 sudo apt-get install ros-hydro-pocketsphinx
 ```

## Populating the robot knowledge base

### Navigation

For navigation the robot needs:

1. A map of the environment ([see tutorial](http://wiki.ros.org/turtlebot_navigation/Tutorials/Build%20a%20map%20with%20SLAM))
2. A database of locations on the map

A location database is a Python [shelve](https://docs.python.org/2/library/shelve.html) file mapping strings to PoseStamped messages. You can generate one with `save_locations.py` in pr2_eup_samples.

Run save_locations.py with the name of a database file. If it doesn't exist, it will be created:
```
python save_locations.py ~/data/locations.db
```

Type `set Home` to save the current position as "Home". Drive the robot around using teleop, and save as many locations as you like.

### Voice

The robot has a database of sounds it can play. Currently it has 10 sounds stored in the pr2_eup/sounds

### Speech

The robot has a database of commands it can recognize. To change this list of commands, open ```pr2_eup/speech/commands.corpus``` and add your own list. Then upload your list to the [Sphinx language model generator tool](http://www.speech.cs.cmu.edu/tools/lmtool-new.html). Download the .dic and .lm files generated by the tool, rename them as ```commands.lm``` and ```commands.dic```, and replace the old ones in ```pr2_eup/speech/```.


## Running end-user scripts

### TURTLEBOT

On the PR2, run:
```
robot start
roslaunch todo_todo todo.launch map_file:=/your/map/file.yaml
```

On the PR2, go to `pr2_eup/web/rapid_web_interface` and type `meteor`. Visit `localhost:3000` in a web browser and full-screen it.

On your workstation, run:
```
rosrun pr2_eup_samples test_all.py
```

